using YubikStudioCore.Forms.Fields;
using YubikStudioCore;
using YubikStudioCore.Documents;
using YubikStudioCore.Attributes;
using YubikStudioCore.Forms;
using YubikStudioCore.Forms.Attributes;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using Intercos.WorkItems;
using Intercos.BusinessObjects;

namespace Intercos.Forms
{
  public class IngredientRow : SubForm<Ingredient>
  {

    public virtual TextField Description { get; set; }
    public virtual BoLookupField<Material> Material { get; set; }
    public virtual DecimalField Percentage { get; set; }
    [Unbound]
    public virtual TextField PercentageTxt { get; set; }
    public virtual EnumField<FormulaPhase> Phase { get; set; }
    public virtual DecimalField Quantity { get; set; }
    [Unbound]
    public virtual TextField QuantityTxt { get; set; }
    [Unbound]
    public virtual TextField UoM { get; set; }

    public override void OnLoad()
    {
      base.OnLoad();
      UoM.Value = Material.Value?.UoM ?? string.Empty;
      PercentageTxt.Value = Percentage.Value.ToString();
      QuantityTxt.Value = Quantity.Value.ToString();
    }

    public override void ConfigureFields()
    {
      base.ConfigureFields();
      //Description.DependsOn = [nameof(Material)];
      //Material.Required = true;
      UoM.ColumnWidth = "10%";
      Percentage.ColumnWidth = "10%";
      Quantity.ColumnWidth = "10%";
      Phase.ColumnWidth = "10%";
      Material.ColumnWidth = "25%";

    }
    public override FormPart GetLayout()
    {
      return Flat(Description, Material, Percentage, Phase, Quantity, UoM);
    }
  }

}
